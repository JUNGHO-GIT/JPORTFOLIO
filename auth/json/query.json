use("JPORTFOLIO_TEST");

// "skills_section" 배열안의
// "skills_section_sub"  배열안의
// "skills_section_sub_value" 가 "" 값을 "" 로 변경
db.getCollection("Skills").updateMany(
  {
    "skills_section.skills_section_sub.skills_section_sub_value": "NodeJs"
  },
  {
    $set: {
      "skills_section.$[outer].skills_section_sub.$[inner].skills_section_sub_value": "Node"
    }
  },
  {
    arrayFilters: [
      {
        "outer.skills_section_sub.skills_section_sub_value": "NodeJs"
      },
      {
        "inner.skills_section_sub_value": "NodeJs"
      }
    ]
  }
);

// "project_section" 배열안의
// "project_section_title" 가 "Backend" 이고 같은 수준안의의
// "project_section_contents"  배열안의
// "project_contents_title" 가 "Language" 이고 같은 수준안의의
// "project_contents_detail" 배열안의
// "project_detail_value" 가 "Nodejs" 값을 "Node" 로 변경
db.getCollection("Projects").updateMany(
  {
    "project_section.project_section_contents.project_contents_detail.project_detail_value": "Nodejs"
  },
  {
    $set: {
      "project_section.$[outer].project_section_contents.$[inner].project_contents_detail.$[inner2].project_detail_value": "Node"
    }
  },
  {
    arrayFilters: [
      {
        "outer.project_section_contents.project_contents_detail.project_detail_value": "Nodejs"
      },
      {
        "inner.project_contents_detail.project_detail_value": "Nodejs"
      },
      {
        "inner2.project_detail_value": "Nodejs"
      }
    ]
  }
);

/**
  "project_section" 배열안의
  "project_section_title" 가 "Backend" 이고 같은 수준안의
  "project_section_contents"  배열안의
  "project_contents_title" 가 "Language" 이고 같은 수준안의
  "project_contents_detail" 배열안의
  {
    "project_detail_icon": "nodejs",
    "project_detail_value": "Node"
  }
  값을
  {
    "project_detail_icon": "nodejs",
    "project_detail_value": "Node"
  },
  {
    "project_detail_icon": "js",
    "project_detail_value": "Js"
  },
  {
    "project_detail_icon": "ts",
    "project_detail_value": "Ts"
  }
  로 변경
**/
db.getCollection("Projects").updateMany(
  {
    "project_section.project_section_title": "Backend",
    "project_section.project_section_contents.project_contents_title": "Language",
    "project_section.project_section_contents.project_contents_detail": {
      $elemMatch: {
        "project_detail_icon": "nodejs",
        "project_detail_value": "Node"
      }
    }
  },
  {
    $set: {
      "project_section.$[section].project_section_contents.$[contents].project_contents_detail": [
        {
          "project_detail_icon": "nodejs",
          "project_detail_value": "Node"
        },
        {
          "project_detail_icon": "js",
          "project_detail_value": "Js"
        },
        {
          "project_detail_icon": "ts",
          "project_detail_value": "Ts"
        }
      ]
    }
  },
  {
    arrayFilters: [
      { "section.project_section_title": "Backend" },
      { "contents.project_contents_title": "Language" }
    ]
  }
);
